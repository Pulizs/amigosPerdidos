<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getFirestore, getDocs, getDoc, doc, collection } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

 const firebaseConfig = {
    apiKey: "AIzaSyCffiFbyNzZz7M9bbNVg6XQaEht-QWHuXU",
    authDomain: "http://sos-pulseiras.firebaseapp.com",
    projectId: "sos-pulseiras",
    storageBucket: "http://sos-pulseiras.firebasestorage.app",
    messagingSenderId: "940338535189",
    appId: "1:940338535189:web:6f039855d2f96258cca71c"
  };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  async function carregarPerfil() {
    const params = new URLSearchParams(window.location.search);
    const idDono = params.get('id');
    const container = document.getElementById('conteudo-perfil');

    if (!idDono) return;

    // Buscar dono e todos os outros amigos em paralelo
    const donoSnap = await getDoc(doc(db, "amigos", idDono));
    const todosSnap = await getDocs(collection(db, "amigos"));

    if (donoSnap.exists()) {
      const dono = donoSnap.data();
      let outrosHTML = '';

      todosSnap.forEach(s => {
        if(s.id !== idDono) {
          const a = s.data();
          outrosHTML += `
            <div class="bg-white p-4 rounded-2xl flex items-center justify-between shadow-sm">
                <p class="font-bold text-slate-700 text-sm">${a.nome.split(' ')[0]}</p>
                <a href="tel:${a.tel}" class="text-green-500"><i class="ph ph-phone-fill text-xl"></i></a>
            </div>`;
        }
      });

      // Renderiza o HTML (Use o template que já criamos antes, injetando as variáveis)
      container.innerHTML = `... (insira o template HTML do perfil aqui usando as variáveis dono.nome, dono.alergias, etc) ...`;
    }
  }
  carregarPerfil();
</script>